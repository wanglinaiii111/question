(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"RnW+":function(e,t,l){"use strict";l("gb4s")},Wnr9:function(e,t,l){"use strict";l.r(t);var s={name:"student",data:function(){return{dialogAddStu:!1,formInline:{level:"",cno:""},stuForm:{sname:"",sno:"",sex:"男",class:""},options:[],tableData:[]}},mounted:function(){(this.$route.query.level||this.$route.query.cno)&&(this.formInline={level:this.$route.query.level,cno:this.$route.query.cno}),this.getList(),this.getClassList()},methods:{getList:function(){var e=this,t={all:1};(this.formInline.level||this.formInline.cno)&&(t={level:this.formInline.level,cno:this.formInline.cno}),this.$request.fetchSearchStu(t).then((function(t){e.tableData=t.data.result})).catch((function(e){console.log(e)}))},getClassList:function(){var e=this;this.$request.fetchSearchClass({level:"",headteacher:""}).then((function(t){for(var l=t.data.result,s=[],o=function(e){var t=l[e],o=s.find((function(e){return e.value===t.level}));o||(o={value:t.level,label:t.level,children:[]},s.push(o)),o.children.push({value:t.id,label:t.cno})},n=0;n<l.length;n++)o(n);e.options=s})).catch((function(t){console.log(t),e.$message({showClose:!0,message:"班级列表数据获取失败！",type:"error"})}))},delete:function(e){var t=this;this.$request.fetchDelStu({id:e}).then((function(e){t.getList(),t.$message({showClose:!0,message:"删除成功！",type:"success"})})).catch((function(e){console.log(e),t.$message({showClose:!0,message:"删除失败！",type:"error"})}))},onSubmit:function(){this.getList()},handleDelete:function(e){this.delete(e.id)},showDialog:function(){this.dialogAddStu=!0},submitAddStuForm:function(){var e=this;this.$request.fetchAddStu({sname:this.stuForm.sname,sno:this.stuForm.sno,sex:this.stuForm.sex,classid:this.stuForm.class}).then((function(t){if(t.data.result)return e.dialogAddStu=!1,e.getList(),void e.$message({showClose:!0,message:"添加成功！",type:"success"});t.data.desc&&e.$message({showClose:!0,message:t.data.desc,type:"error"})})).catch((function(t){console.log(t),e.$message({showClose:!0,message:"添加失败！",type:"error"})}))},handleChange:function(e){console.log(e),this.stuForm.class=e[1]}}},o=(l("RnW+"),l("KHd+")),n=Object(o.a)(s,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",["ordinary"!==e.$store.getters.info.role?l("el-button",{staticClass:"addBtn",attrs:{size:"medium"},on:{click:e.showDialog}},[e._v("添加学生")]):e._e(),e._v(" "),[l("div",{staticClass:"card"},[l("el-form",{attrs:{inline:!0,model:e.formInline}},[l("el-form-item",{attrs:{label:"年级"}},[l("el-date-picker",{attrs:{type:"year","value-format":"yyyy",placeholder:"选择年级",size:"medium",format:"yyyy届"},model:{value:e.formInline.level,callback:function(t){e.$set(e.formInline,"level",t)},expression:"formInline.level"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"班号"}},[l("el-input",{attrs:{size:"medium",placeholder:"班号"},model:{value:e.formInline.cno,callback:function(t){e.$set(e.formInline,"cno",t)},expression:"formInline.cno"}})],1),e._v(" "),l("el-form-item",[l("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1),e._v(" "),l("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[l("el-table-column",{attrs:{prop:"sname",label:"学生姓名"}}),e._v(" "),l("el-table-column",{attrs:{prop:"sno",label:"学号"}}),e._v(" "),l("el-table-column",{attrs:{prop:"level",label:"年级"}}),e._v(" "),l("el-table-column",{attrs:{prop:"cno",label:"班级"}}),e._v(" "),l("el-table-column",{attrs:{prop:"headteacher",label:"班主任"}}),e._v(" "),"ordinary"!==e.$store.getters.info.role?l("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-popconfirm",{attrs:{title:"确定删除该名学生吗？"},on:{confirm:function(l){return e.handleDelete(t.row)}}},[l("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v("删除")])],1)]}}],null,!1,3458613594)}):e._e()],1)],e._v(" "),l("el-dialog",{attrs:{title:"添加学生",visible:e.dialogAddStu,width:"337px"},on:{"update:visible":function(t){e.dialogAddStu=t}}},[l("el-form",{attrs:{model:e.stuForm,"label-width":"80px"}},[l("el-form-item",{attrs:{label:"学生姓名",placeholder:"请输入学生姓名"}},[l("el-input",{model:{value:e.stuForm.sname,callback:function(t){e.$set(e.stuForm,"sname",t)},expression:"stuForm.sname"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"学号",placeholder:"请输入学生学号"}},[l("el-input",{model:{value:e.stuForm.sno,callback:function(t){e.$set(e.stuForm,"sno",t)},expression:"stuForm.sno"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"性别"}},[l("el-select",{attrs:{size:"medium",placeholder:"请选择性别",filterable:""},model:{value:e.stuForm.sex,callback:function(t){e.$set(e.stuForm,"sex",t)},expression:"stuForm.sex"}},[l("el-option",{attrs:{label:"男",value:"男"}}),e._v(" "),l("el-option",{attrs:{label:"女",value:"女"}})],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"班级"}},[l("el-cascader",{attrs:{options:e.options},on:{change:e.handleChange},model:{value:e.stuForm.class,callback:function(t){e.$set(e.stuForm,"class",t)},expression:"stuForm.class"}})],1)],1),e._v(" "),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogAddStu=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitAddStuForm()}}},[e._v("确 定")])],1)],1)],2)}),[],!1,null,"274d9b05",null);t.default=n.exports},gb4s:function(e,t,l){}}]);
//# sourceMappingURL=11.568a242bcb74ab72f6a1.js.map