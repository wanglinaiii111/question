(window.webpackJsonp=window.webpackJsonp||[]).push([[1,4],{"/v30":function(t,e,n){"use strict";n("bqGB")},"5FF5":function(t,e,n){"use strict";var r=n("4d7F"),o=n.n(r),a=n("m1cH"),s=n.n(a),i=n("QbLZ"),u=n.n(i),l={name:"confirm-group",props:["groupTableData","form","curGroupData"],data:function(){var t=this,e=function(){for(var e={},n=[],r=0;r<t.groupTableData.length;r++)e["group"+t.groupTableData[r].id]=[],n.push(u()({},t.groupTableData[r]));return{obj:e,list:n}};return{checkList:[],group:e().obj,studentList:{},groupData:e().list}},mounted:function(){this.getStudentList()},methods:{getStudentList:function(){var t=this;this.$request.fetchSearchStu({level:this.form.level,cno:this.form.cno}).then((function(e){for(var n=e.data.result,r={},o=0;o<n.length;o++)r[n[o].sno]=n[o];t.studentList=r;for(var a=[],i=0;i<t.groupData.length;i++){var l=t.groupData[i].snos,c=t.getStuList(l);a.push.apply(a,s()(c));for(var _=0;_<l.length;_++)t.studentList[l[_][0]]=u()({},t.studentList[l[_][0]],{score:l[_][1]})}for(var d=0;d<a.length;d++)t.studentList[a[d].sno]&&(t.studentList[a[d].sno]=u()({},t.studentList[a[d].sno],{isGroup:!0}))}))},add:function(t){for(var e=this.checkList,n=0;n<e.length;n++)this.studentList[e[n]]=u()({},this.studentList[e[n]],{isGroup:!0});var r=[];for(var o in this.group)if(r.push.apply(r,s()(this.group[o])),this.group[o].length>0){var a=o.split("group")[1];this.del(a,"delOther")}e=[].concat(s()(e),r);for(var i=0;i<this.groupData.length;i++)if(this.groupData[i].id===t&&e.length>0){for(var l=[],c=0;c<e.length;c++)l.push([e[c]+"",this.studentList[e[c]].score]);this.groupData[i].snos=[].concat(s()(this.groupData[i].snos),l)}this.checkList=[]},del:function(t,e){for(var n=this.group["group"+t],r=0;r<n.length;r++)this.studentList[n[r]]=u()({},this.studentList[n[r]],{isGroup:"delOther"===e});for(var o=0;o<this.groupData.length;o++)if(+this.groupData[o].id==+t){var a=this.getStuList(this.groupData[o].snos).filter((function(t){return!n.includes(t.sno)})).map((function(t){return[t.sno,t.score]}));this.groupData[o].snos=a}this.group["group"+t]=[]},getStuList:function(t){var e=this;return t?t.map((function(t){return{sno:t[0],score:t[1],sname:e.studentList[t[0]]?e.studentList[t[0]].sname:"未知"}})):[]},confirmBtn:function(){for(var t=this,e=0;e<this.groupData.length;e++){for(var n=this.groupData[e].snos,r=[],a=0;a<n.length;a++)r.push("("+n[a][0]+","+n[a][1]+")");r.push(this.confirmUpdate(this.groupData[e].id,this.groupData[e].is_sure_student,this.groupData[e].is_sure_question,this.groupData[e].groupid,"["+r.join()+"]"))}o.a.all([]).then((function(){t.$emit("getConfirmStatus",!0)})).catch((function(){t.$message.error("确认失败")}))},confirmUpdate:function(t,e,n,r,o){var a=this;this.$request.fetchUpdategroup({id:t,is_sure_student:+t==+this.curGroupData.id?1:e,is_sure_question:n,groupid:r,snos:o}).then((function(t){t.data.desc&&a.$message.error(t.data.desc)}))},getWeakKnowledge:function(t){for(var e=t.split("||"),n=[],r=0;r<e.length;r++)n.push(e[r].split("_")[0]);return n}}},c=(n("/v30"),n("KHd+")),_=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",[t._v("未分组学生列表")]),t._v(" "),n("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[t._l(Object.values(t.studentList),(function(e){return[e.isGroup?t._e():n("el-checkbox",{key:e.id,attrs:{label:e.sno}},[t._v(t._s(e.sname))])]}))],2),t._v(" "),n("el-divider"),t._v(" "),t._l(t.groupData,(function(e){return n("div",{key:e.id,staticClass:"list"},[n("div",{staticClass:"title"},[n("h3",{style:{color:+e.id==+t.curGroupData.id?"#409EFF":"#606266"}},[t._v("\n        "+t._s(e.level)+"届-"+t._s(e.cno)+"班-"+t._s(e.groupid)+"组"),+e.id==+t.curGroupData.id?n("Span",[t._v("(当前修改的分组)")]):t._e()],1),t._v(" "),0==+e.is_sure_student?n("div",[n("el-button",{staticClass:"btn",attrs:{size:"mini"},on:{click:function(n){return t.add(e.id)}}},[t._v("添加到当前分组")]),t._v(" "),n("el-button",{staticClass:"btn",attrs:{size:"mini"},on:{click:function(n){return t.del(e.id)}}},[t._v("从当前分组删除")])],1):n("div",[n("el-button",{staticClass:"btn",attrs:{size:"mini",disabled:""}},[t._v("已确认")])],1)]),t._v(" "),n("h5",[t._v("薄弱知识点")]),t._v(" "),n("div",{staticClass:"point"},[t._v("\n      "+t._s(t.getWeakKnowledge(e.weakpoints_and_rate).join("、"))+"\n    ")]),t._v(" "),n("el-checkbox-group",{attrs:{disabled:1==+e.is_sure_student},model:{value:t.group["group"+e.id],callback:function(n){t.$set(t.group,"group"+e.id,n)},expression:"group['group' + item.id]"}},t._l(t.getStuList(e.snos),(function(e){return n("el-checkbox",{key:e.sno,attrs:{label:e.sno}},[t._v(t._s(e.sname))])})),1),t._v(" "),n("el-divider")],1)})),t._v(" "),n("el-popconfirm",{attrs:{title:"确定确认分组吗？确认后将不再可修改！"},on:{confirm:function(e){return t.confirmBtn()}}},[n("el-button",{attrs:{slot:"reference",type:"primary",size:"medium"},slot:"reference"},[t._v("确认分组")])],1)],2)}),[],!1,null,"0496d018",null);e.a=_.exports},"5K62":function(t,e,n){},Eiiv:function(t,e){"undefined"!=typeof jQuery&&"undefined"!=typeof saveAs?function(t){t.fn.wordExport=function(e){e=void 0!==e?e:"jQuery-Word-Export";var n={mhtml:{top:"Mime-Version: 1.0\nContent-Base: "+location.href+'\nContent-Type: Multipart/related; boundary="NEXT.ITEM-BOUNDARY";type="text/html"\n\n--NEXT.ITEM-BOUNDARY\nContent-Type: text/html; charset="utf-8"\nContent-Location: '+location.href+"\n\n<!DOCTYPE html>\n<html>\n_html_</html>",head:'<head>\n<meta http-equiv="Content-Type" content="text/html; charset=utf-8">\n<style>\n_styles_\n</style>\n</head>\n',body:"<body>_body_</body>"}},r=624,o=t(this).clone();o.each((function(){var e=t(this);e.is(":hidden")&&e.remove()}));var a=Array(),s=o.find("img");console.log(s);for(var i=0;i<s.length;i++){var u=Math.min(s[i].width,r),l=s[i].height*(u/s[i].width),c=document.createElement("CANVAS");c.width=u,c.height=l,c.getContext("2d").drawImage(s[i],0,0,u,l),t(s[i]).attr("src",s[i].src)}var _="\n";for(i=0;i<a.length;i++)_+="--NEXT.ITEM-BOUNDARY\n",_+="Content-Location: "+a[i].location+"\n",_+="Content-Type: "+a[i].type+"\n",_+="Content-Transfer-Encoding: "+a[i].encoding+"\n\n",_+=a[i].data+"\n\n";_+="--NEXT.ITEM-BOUNDARY--";var d=n.mhtml.top.replace("_html_",n.mhtml.head.replace("_styles_","")+n.mhtml.body.replace("_body_",o.html()))+_,p=new Blob([d],{type:"application/msword;charset=utf-8"});saveAs(p,e+".doc")}}(jQuery):("undefined"==typeof jQuery&&console.error("jQuery Word Export: missing dependency (jQuery)"),"undefined"==typeof saveAs&&console.error("jQuery Word Export: missing dependency (FileSaver.js)"))},Iab2:function(t,e,n){(function(n){var r,o,a;o=[],void 0===(a="function"==typeof(r=function(){"use strict";function e(t,e,n){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){i(r.response,e,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function o(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n&&n.global===n?n:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(t,n,s){var i=a.URL||a.webkitURL,u=document.createElement("a");n=n||t.name||"download",u.download=n,u.rel="noopener","string"==typeof t?(u.href=t,u.origin===location.origin?o(u):r(u.href)?e(t,n,s):o(u,u.target="_blank")):(u.href=i.createObjectURL(t),setTimeout((function(){i.revokeObjectURL(u.href)}),4e4),setTimeout((function(){o(u)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,a){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,a),n);else if(r(t))e(t,n,a);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout((function(){o(s)}))}}:function(t,n,r,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,r);var i="application/octet-stream"===t.type,u=/constructor/i.test(a.HTMLElement)||a.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||i&&u||s)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=l?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=t:location=t,o=null},c.readAsDataURL(t)}else{var _=a.URL||a.webkitURL,d=_.createObjectURL(t);o?o.location=d:location.href=d,o=null,setTimeout((function(){_.revokeObjectURL(d)}),4e4)}});a.saveAs=i.saveAs=i,t.exports=i})?r.apply(e,o):r)||(t.exports=a)}).call(this,n("yLpj"))},TTmx:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r={htmlEncodeByRegExp:function(t){return 0==t.length?"":t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\s/g,"&nbsp;").replace(/\'/g,"&#39;").replace(/\"/g,"&quot;")},htmlDecodeByRegExp:function(t){return 0==t.length?"":t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&#39;/g,"'").replace(/&quot;/g,'"')}}},Zndv:function(t,e,n){"use strict";n.r(e);var r=n("v487").a,o=(n("k0zR"),n("KHd+")),a=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["group"===t.groupLevel?n("div",[n("el-form",{ref:"form",staticClass:"myForm",attrs:{model:t.form,"label-width":"100px",size:"medium","label-position":"left"}},[n("el-form-item",{attrs:{label:"年级"}},[n("el-date-picker",{attrs:{type:"year","value-format":"yyyy",placeholder:"选择年级",format:"yyyy届"},on:{change:t.changeLevel},model:{value:t.form.level,callback:function(e){t.$set(t.form,"level",e)},expression:"form.level"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"班号"}},[n("el-select",{model:{value:t.form.cno,callback:function(e){t.$set(t.form,"cno",e)},expression:"form.cno"}},t._l(t.classList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.cno,value:t.cno}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"考试科目"}},[n("el-cascader",{attrs:{options:t.options,"show-all-levels":!0,size:"medium"},on:{change:t.changeExamId},model:{value:t.examSub,callback:function(e){t.examSub=e},expression:"examSub"}})],1),t._v(" "),n("el-form-item",{staticClass:"myFooter"},[n("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")]),t._v(" "),n("el-popconfirm",{attrs:{title:"确定删除当前考试下的所有分组吗？"},on:{confirm:t.delGroup}},[n("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除分组")])],1)],1)],1),t._v(" "),n("el-table",{attrs:{data:t.tableData}},[n("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.getTableData(e.row.snos),border:""}},[n("el-table-column",{attrs:{prop:"sname",label:"学生姓名"}}),t._v(" "),n("el-table-column",{attrs:{prop:"sno",label:"学号"}}),t._v(" "),n("el-table-column",{attrs:{prop:"score",label:"能力值"}})],1)]}}],null,!1,2476887454)}),t._v(" "),n("el-table-column",{attrs:{prop:"groupid",label:"组号"}}),t._v(" "),n("el-table-column",{attrs:{prop:"rank",label:"所属分级"}}),t._v(" "),n("el-table-column",{attrs:{prop:"weakpoints_and_rate",label:"薄弱知识点信息"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("el-button",{attrs:{size:"mini"},on:{click:function(n){return t.showPoint(e.row)}}},[t._v("查看")])],1)]}}],null,!1,3754853410)}),t._v(" "),n("el-table-column",{attrs:{label:"是否确认学生"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[0==+e.row.is_sure_student?n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){return t.confirmCurGroup(e.row)}}},[t._v("确认分组")]):n("span",[t._v("已确认")])],1)]}}],null,!1,2394477611)}),t._v(" "),n("el-table-column",{attrs:{label:"是否确认题目"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[0==+e.row.is_sure_question?n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){return t.handleShowQues(e.row)}}},[t._v("确认试题")]):n("el-button",{attrs:{size:"mini"},on:{click:function(n){return t.handleShowQues(e.row)}}},[t._v("查看推荐试题")])],1)]}}],null,!1,2668951568)})],1),t._v(" "),n("el-dialog",{attrs:{title:"确认当前分组",visible:t.dialogFormVisible,width:"650px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[t.dialogFormVisible?n("ConfirmGroup",{attrs:{form:t.form,groupTableData:t.tableData,curGroupData:t.curGroupData},on:{getConfirmStatus:t.getConfirmStatus}}):t._e()],1),t._v(" "),n("el-dialog",{attrs:{title:"薄弱知识点信息",visible:t.dialogPoint,width:"650px"},on:{"update:visible":function(e){t.dialogPoint=e}}},[n("el-table",{attrs:{data:t.gridData}},[n("el-table-column",{attrs:{property:"weakpoint",label:"薄弱知识点"}}),t._v(" "),n("el-table-column",{attrs:{property:"rate",label:"正确率"}})],1)],1)],1):n("RecommendQues",{attrs:{curGroupData:t.curGroupData}})],1)}),[],!1,null,"fda7e22c",null);e.default=a.exports},bPau:function(t,e,n){"use strict";n("gWwP")},bqGB:function(t,e,n){},gWwP:function(t,e,n){},k0zR:function(t,e,n){"use strict";n("5K62")},rqBn:function(t,e,n){"use strict";n.r(e);n("Iab2"),n("Eiiv");var r=n("TTmx"),o=n("jWbq"),a={name:"recommend-ques",props:["curGroupData"],data:function(){return{url:o.b,HtmlUtil:r.a,questionList:[],diffMap:{.94:"容易",.85:"较易",.65:"中等",.64:"中等",.4:"较难",.15:"困难",0:"困难"}}},mounted:function(){console.log(this.curGroupData),this.getList()},methods:{getList:function(){var t=this;this.$request.fetchSelectquestion({id:this.curGroupData.id}).then((function(e){if(0===e.data.length)return t.getQuestion();t.questionList=e.data}))},getQuestion:function(){var t=this;this.$request.fetchGetProblem({rank:this.curGroupData.rank,weakKnowledge:this.getWeakKnowledge(this.curGroupData.weakpoints_and_rate),subjectId:this.curGroupData.subjectId[1]}).then((function(e){if(0===e.data.length)return t.$message.error("该分组没有获取到推荐试题");t.addQuestion(e.data.data)}))},addQuestion:function(t){var e=this;this.$request.fetchAddquestion({id:this.curGroupData.id,qid_list:t}).then((function(t){if(!t.data.result)return e.$message.error("推荐试题添加失败");e.getList()}))},getWeakKnowledge:function(t){for(var e=t.split("||"),n=[],r=0;r<e.length;r++)n.push(e[r].split("_")[0]);return n},deleteQues:function(t){var e=this;this.$request.fetchDelquestion({id:t}).then((function(t){if(t.data.desc)return e.$message.error(t.data.desc);e.getList(),e.$message({showClose:!0,message:"删除成功！",type:"success"})}))},confirmUpdate:function(){var t=this;this.$request.fetchUpdategroup({id:this.curGroupData.id,is_sure_student:this.curGroupData.is_sure_student,is_sure_question:1,groupid:this.curGroupData.groupid,snos:this.curGroupData.snos}).then((function(e){if(e.data.desc)return t.$message.error(e.data.desc);t.$message.success("确定成功"),t.back()})).catch((function(t){console.log(t)}))},isImage:function(t){if(t)return 0==t.indexOf("http")},getNo:function(t){return t?t.split("13q")[1].split(".html")[0]:""},back:function(){this.$store.dispatch("setGroupLevel","group")},download:function(){$("#myHtml").wordExport(this.curGroupData.level+"届-"+this.curGroupData.cno+"班-"+this.curGroupData.groupid+"组推荐试题")}}},s=(n("bPau"),n("KHd+")),i=Object(s.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-button",{staticClass:"back",attrs:{size:"medium"},on:{click:t.back}},[t._v("返回上一级")]),t._v(" "),n("el-popconfirm",{attrs:{title:"确定确认试题吗？确认后将不再可修改！"},on:{confirm:function(e){return t.confirmUpdate()}}},[0==+t.curGroupData.is_sure_question?n("el-button",{staticClass:"addBtn",attrs:{slot:"reference",size:"medium"},slot:"reference"},[t._v("确认试题")]):t._e()],1),t._v(" "),1==+t.curGroupData.is_sure_question?n("el-button",{staticClass:"addBtn",attrs:{size:"medium"},on:{click:t.download}},[t._v("导出word")]):t._e(),t._v(" "),n("div",{attrs:{id:"myHtml"}},t._l(t.questionList,(function(e){return n("el-card",{key:e.id,staticClass:"box-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("div",[n("span",[t._v("题号："+t._s(e.qno))]),t._v(" "),n("el-divider",{attrs:{direction:"vertical"}}),t._v(" "),n("span",[t._v(t._s(-1!==e.qtype.indexOf("题型")?e.qtype:"题型："+e.qtype))]),t._v(" "),n("el-divider",{attrs:{direction:"vertical"}}),t._v(" "),n("span",[t._v(t._s(e.source))]),t._v(" "),n("el-divider",{attrs:{direction:"vertical"}}),t._v(" "),n("span",[t._v("\n            "+t._s(-1!==e.difficulty.indexOf("难度")?t.diffMap[e.difficulty]:"难度："+t.diffMap[e.difficulty])+"\n          ")])],1),t._v(" "),0==+t.curGroupData.is_sure_question?n("div",{staticClass:"toolBtn"},[n("el-popconfirm",{attrs:{title:"确定删除这道题吗？"},on:{confirm:function(n){return t.deleteQues(e.id)}}},[n("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[t._v("删除")])],1)],1):t._e()]),t._v(" "),n("div",[n("div",{staticClass:"title"},[n("span",{domProps:{innerHTML:t._s(t.HtmlUtil.htmlDecodeByRegExp(e.stem))}})]),t._v(" "),t.isImage(e.answer)?n("img",{attrs:{src:t.url+"exam/download?filename="+t.getNo(e.weburl)+".png&answerpic=1&stempic=",alt:""}}):n("span",{domProps:{innerHTML:t._s(t.HtmlUtil.htmlDecodeByRegExp(e.answer))}}),t._v(" "),n("h4",[t._v("知识点:")]),t._v(" "),n("span",[t._v(t._s(e.points.replace(/[\s]+/g,"    ")))])])])})),1)],1)}),[],!1,null,"1ed9779c",null);e.default=i.exports},v487:function(module,__webpack_exports__,__webpack_require__){"use strict";var babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("14Xm"),babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("D3Ub"),babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__),babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("QbLZ"),babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2__),_recommendQues_vue__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("rqBn"),_confirmGroup_vue__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("5FF5");__webpack_exports__.a={name:"group-table",components:{RecommendQues:_recommendQues_vue__WEBPACK_IMPORTED_MODULE_3__.default,ConfirmGroup:_confirmGroup_vue__WEBPACK_IMPORTED_MODULE_4__.a},data:function(){return{dialogFormVisible:!1,dialogPoint:!1,form:{level:(new Date).getFullYear()+"",cno:""},formDialog:{},updateDate:{},examSub:[],options:[],tableData:[],classList:[],studentMap:{},curGroupData:null,gridData:[]}},beforeRouteLeave:function(t,e,n){this.$store.dispatch("setGroupLevel","group"),n()},mounted:function(){this.getClassList(),this.getExamList()},computed:{groupLevel:function(){return this.$store.getters.groupLevel}},watch:{groupLevel:function(t,e){"group"===t&&this.search()}},methods:{getList:function getList(){var _this=this;if(0===this.examSub.length)return this.$message.error("请选择考试科目");this.$request.fetchSearchgroup({level:this.form.level,cno:this.form.cno,exam_detail_id:this.examSub[1]}).then((function(res){var result=res.data.result;_this.tableData=result.map((function(item){var snos=void 0;return eval("snos = "+item.snos.replace(/\(/g,"[").replace(/\)/g,"]")),babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({},item,{snos:snos})}))}))},getClassList:function(){var t=this;this.$request.fetchSearchClass({level:this.form.level,headteacher:""}).then((function(e){var n=e.data.result;t.classList=n,n.length>0&&(t.form.cno=n[0].cno)}))},getExamList:function(){var t=this;this.$request.fetchSelectExam({}).then((function(e){var n;t.options=[],e.data.result.map((n=babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function e(n,r){var o;return babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getExam_subjectList(n.exam_id);case 2:return o=e.sent,t.options.push({value:n.exam_id,label:n.name,children:[]}),o.map((function(e){t.options[r].children.push({value:e.exam_detail_id,label:e.subject_name})})),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,t)}))),function(t,e){return n.apply(this,arguments)}))})).catch((function(t){console.log(t)}))},getExam_subjectList:function(t){return this.$request.fetchSelectExamsubject({exam_id:t}).then((function(t){return t.data})).catch((function(t){console.log(t)}))},getStudentList:function(){var t=this;this.$request.fetchSearchStu({level:this.form.level,cno:""}).then((function(e){for(var n=e.data.result,r={},o=0;o<n.length;o++)r[n[o].sno]=n[o];t.studentMap=r})).catch((function(t){console.log(t)}))},changeLevel:function(t){this.form.level=t,this.getClassList()},changeExamId:function(t){this.examSub=t},search:function(){var t=this;return babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark((function e(){return babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getList();case 2:return e.next=4,t.getStudentList();case 4:case"end":return e.stop()}}),e,t)})))()},getTableData:function(t){var e=this;return t?t.map((function(t){return{sno:t[0],score:t[1],sname:e.studentMap[t[0]]?e.studentMap[t[0]].sname:""}})):[]},confirmUpdate:function(){var t=this;this.$request.fetchUpdategroup({id:this.formDialog.id,is_sure_student:this.formDialog.is_sure_student,is_sure_question:this.formDialog.is_sure_question,groupid:this.formDialog.groupid,snos:this.formDialog.snos}).then((function(e){t.dialogFormVisible=!1,e.data.desc&&t.$message.error(e.data.desc),t.search()})).catch((function(t){console.log(t)}))},confirmCurGroup:function(t){this.dialogFormVisible=!0,this.curGroupData=t},delGroup:function(){var t=this;if(0===this.examSub.length)return this.$message.error("请选择要删除分组的考试科目");this.$request.fetchDelgroup({exam_detail_id:this.examSub[1]}).then((function(e){t.search(),t.$message({showClose:!0,message:"删除成功！",type:"success"})}))},handleShowQues:function(t){this.curGroupData=babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_2___default()({},t,{subjectId:this.examSub}),this.$store.dispatch("setGroupLevel","ques")},getConfirmStatus:function(t){this.getList(),this.dialogFormVisible=!1},showPoint:function(t){this.dialogPoint=!0,this.gridData=this.getWeakKnowledge(t.weakpoints_and_rate)},getWeakKnowledge:function(t){for(var e=t.split("||"),n=[],r=0;r<e.length;r++)n.push({weakpoint:e[r].split("_")[0],rate:100*e[r].split("_")[1]+"%"});return n}}}}}]);
//# sourceMappingURL=1.e43e212179e9167b7625.js.map